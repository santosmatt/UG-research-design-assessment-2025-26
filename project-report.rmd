---
title: "Group project assessment [template]"
author: '[update with group members'' exam numbers]'
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

NOTE: Please don't edit this template directly. Use `File` > `Save as` to create a copy of this document, rename it (remove the word "template" from the file name) and use that new version to write your report. Make sure to also update the Title and Author fields in the YAML of your .Rmd file.

## Task 1: Reproducing and improving figures

```{r importing-required-packages}

pacman::p_load(magrittr, dplyr, tidyr, ggplot2,ggtext)

```


```{r load-wrangle}
# load and wrangle the data here

postpartum_depression_data_raw <- 
  readr::read_csv(here::here("data", "HIIT-postpartum-depression.csv")) %>% 
  janitor::clean_names()

postpartum_depression_data <- postpartum_depression_data_raw %>% 
  select(intervention_group, 
         edinburg_postnatal_depression_scale_score, 
         pre_fs_scale,
         post_fs_score,
         postnatal_florishing_scale_score,
         pre_sf_12_pcs_physicalhealthscale,
         post_sf12_pcs,
         postnatal_sf_12_pcs
         ) %>% 
  mutate(postnatal_depression_score = 
           as.numeric(edinburg_postnatal_depression_scale_score) %>% 
           cut(breaks = c(0,9,12,30), 
               labels = c("range indicating the norm (below 10 points)",
                      "slightly increased severity PDD symptoms (10-11 points)",
                      "increased severity of PDD symptoms"),
               include.lowest = TRUE))

```


### Figure 3
```{r figure-3}
# Write your code for reproducing, and then improving Figure 3. Present both figures together. Under the figures, explain how you've improved Figure 3 and why you consider this an improvement.
```


### Figure 4
```{r figure-4}
# Write your code for reproducing, and then improving Figure 4. Present both figures together. Under the figures, explain how you've improved Figure 4 and why you consider this an improvement.
```


### Figure 5
```{r figure-5}
# Write your code for reproducing, and then improving Figure 5. Present both figures together. Under the figures, explain how you've improved Figure 5 and why you consider this an improvement.

sf_scores_sd_mean <- postpartum_depression_data %>% 
  select(intervention_group, 
         pre_sf_12_pcs_physicalhealthscale,
         post_sf12_pcs,
         postnatal_sf_12_pcs) %>%
  #two columns where string not numeric
  mutate(postnatal_sf_12_pcs = as.numeric(postnatal_sf_12_pcs),
         post_sf12_pcs = as.numeric(post_sf12_pcs)) %>% 
  #removing those from analysis who missed one or more surveys
  filter(!is.na(postnatal_sf_12_pcs),
         !is.na(post_sf12_pcs)) %>% 
  pivot_longer(pre_sf_12_pcs_physicalhealthscale:postnatal_sf_12_pcs,
               names_to = "time_of_survey",
               values_to = "score") %>% 
  group_by(intervention_group,time_of_survey) %>% 
  summarise(mean_physical_activity_score = mean(score),
            sd_physical_activity_score = sd(score)) %>% 
  #Renaming time_of_survey and intervention_group and changing to factor
  #Ensures have correct labels and allows for correct order/grouping
  mutate(time_of_survey = 
      factor(
        time_of_survey,
        levels = c(
          "pre_sf_12_pcs_physicalhealthscale",
          "post_sf12_pcs",
          "postnatal_sf_12_pcs"),
        labels = c(
          "Before the intevention \n(II trimester of pregnancy)",
          "After the intervention \n(III trimester of pregnancy)",
          "Follow-up \n(Â± 5 months postpartum)")),
      
      intervention_group_factor = 
      factor(
        intervention_group,
        levels = c(
          "1",
          "2"),
        labels = c(
          "HIIT - High Intensity Interval Training Group",
          "EDU - Educational Intervention Group")))

sf_scores_sd_mean %>% 
  ggplot(aes(x = time_of_survey,
             y = mean_physical_activity_score,
             linetype = intervention_group_factor,
             group = intervention_group_factor)) +
  geom_line() +
  theme_light() +
  scale_y_continuous(limits = c(35,60),
                     labels = scales::label_number(accuracy = 0.01),
                     expand = c(0, 0)) +
  labs(y = "",
       x = "**Physical health** (*measured witht the Short Form Health Survey - physical subscale*)") +
  geom_errorbar(aes(ymin = mean_physical_activity_score - sd_physical_activity_score,
                    ymax = mean_physical_activity_score + sd_physical_activity_score,
                    width = .02,
                    linetype = intervention_group_factor)) 
```

Inconsistent data types
Nulls not handelled well
Did not mention that people who did not do all scores where removed
Column names not consistent 
Add label on y column, title etc 
no explict mention of what intevention gorup each in

## Task 2: FAIR data principles

## Task 3: Reproducibility brief
